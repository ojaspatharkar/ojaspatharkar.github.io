!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("lodash"));else if("function"==typeof define&&define.amd)define(["lodash"],n);else{var t="object"==typeof exports?n(require("lodash")):n(e._);for(var o in t)("object"==typeof exports?exports:e)[o]=t[o]}}(window,(function(e){return function(e){var n={};function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(o,i,function(n){return e[n]}.bind(null,i));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=1)}([function(n,t){n.exports=e},function(e,n,t){"use strict";t.r(n),t.d(n,"waitForChangesApplied",(function(){return c})),t.d(n,"save",(function(){return Y})),t.d(n,"application",(function(){return f})),t.d(n,"components",(function(){return l})),t.d(n,"controllers",(function(){return R})),t.d(n,"history",(function(){return w})),t.d(n,"info",(function(){return h})),t.d(n,"language",(function(){return C})),t.d(n,"menu",(function(){return b})),t.d(n,"pages",(function(){return S})),t.d(n,"pagesGroup",(function(){return x})),t.d(n,"routers",(function(){return N})),t.d(n,"siteSegments",(function(){return F})),t.d(n,"siteMembers",(function(){return B})),t.d(n,"fonts",(function(){return P})),t.d(n,"theme",(function(){return W})),t.d(n,"tpa",(function(){return k})),t.d(n,"vfs",(function(){return _})),t.d(n,"mobile",(function(){return j})),t.d(n,"responsiveLayout",(function(){return V})),t.d(n,"accessibility",(function(){return H})),t.d(n,"account",(function(){return z})),t.d(n,"errors",(function(){return X})),t.d(n,"wixapps",(function(){return Z})),t.d(n,"environment",(function(){return J})),t.d(n,"transactions",(function(){return K})),t.d(n,"permissions",(function(){return Q}));var o=t(0),i=t.n(o);const r=Object.freeze({EXTENSION:"extension",DEFAULT:"default"}),p=e=>e.context===r.EXTENSION;function a(e,n,t,{isRequired:o}={isRequired:!1}){const i=p(e)?null==n?void 0:n[t]:null==e?void 0:e[t];if(o&&void 0===i)throw new Error("option ".concat(t," is required"));return i}const s=(e,n)=>new Promise(t=>{e.waitForChangesApplied(()=>t(n))}),c=(e,n)=>e.waitForChangesApplied(n),u=(e,n,t)=>n.runInContext(e,t),d=(e,n)=>!!p(e)||n===e.appDefinitionId;var f={install:function(e,n,t,{appDefinitionId:o,originInfo:r,editorType:p,sourceTemplateId:a,isSilent:s}){return new Promise((t,c)=>{if(!o)return void c(new Error("options must contain appDefinitionId"));const d={appDefinitionId:i.a.get(n,"appDefinitionId")},f=r?i.a.assign({},r,d):d,l={origin:{initiator:"APP",type:p,info:f}};a&&(l.sourceTemplateId=a),s&&(l.isSilent=!0),u(n.appDefinitionId,e,()=>e.platform.provision(o,l).then(t,c))})},uninstall:function(e,n,t,{appDefinitionId:o}={}){return new Promise(t=>{const i=a(n,{appDefinitionId:o},"appDefinitionId",{isRequired:!0});u(n.appDefinitionId,e,()=>e.platform.uninstall(i)),e.waitForChangesApplied(t)})},registerToCustomEvents:function(e,n,t,{eventTypes:o,applicationId:i}){const r=a(n,{applicationId:i},"applicationId",{isRequired:!0});return u(n.appDefinitionId,e,()=>e.platform.registerAppToCustomEvents(r,o))},appStudioWidgets:{changeVariation:function(e,n,t,{componentRef:o,variationId:i}){return new Promise(t=>{u(n.appDefinitionId,e,()=>e.appStudioWidgets.changeVariation(o,i,t))})},changePreset:function(e,n,t,{componentRef:o,stylePresetId:i,layoutPresetId:r}){return u(n.appDefinitionId,e,()=>e.appStudioWidgets.changePreset(o,i,r))},addWidget:function(e,n,t,{containerRef:o,widgetId:i,variationId:r,layout:p,installationType:s,appDefinitionId:c}){return new Promise((t,d)=>{const f=a(n,{appDefinitionId:c},"appDefinitionId",{isRequired:!0});u(n.appDefinitionId,e,()=>e.appStudioWidgets.addWidget(f,i,{containerRef:o,variationId:r,layout:p,installationType:s,onSuccess:t,onError:d}))})}},sessionState:{update:function(e,n,t,{stateMap:o}){return u(n.appDefinitionId,e,()=>e.platform.sessionState.update(o)),s(e)}},livePreview:{refresh:function(e,n,t,{source:o,shouldFetchData:i,appDefinitionId:r}){const p=a(n,{appDefinitionId:r},"appDefinitionId",{isRequired:!0});return e.platform.livePreview.refresh({apps:[p],source:o||"EditorSDK",shouldFetchData:i})}}};var l={add:function(e,n,t,{componentDefinition:o,pageRef:r,customId:p,optionalIndex:a}={}){return new Promise((t,s)=>{i.a.has(o,"componentType")||s(new Error("componentDefinition must contain componentType"));const c=e.components.buildDefaultComponentStructure(o.componentType);i.a.merge(c,o);t(u(n.appDefinitionId,e,()=>e.components.add(r,c,p,a)))})},addAndAdjustLayout:function(e,n,t,{componentDefinition:o,pageRef:r,customId:p,optionalIndex:a}={}){return new Promise((t,s)=>{i.a.has(o,"componentType")||s(new Error("componentDefinition must contain componentType"));const d=e.components.buildDefaultComponentStructure(o.componentType);i.a.merge(d,o);const f=u(n.appDefinitionId,e,()=>e.components.addAndAdjustLayout(r,d,p,a));c(e,()=>t(f))})},remove:function(e,n,t,{componentRef:o}){e.viewMode.get()===e.viewMode.VIEW_MODES.MOBILE?u(n.appDefinitionId,e,()=>e.mobile.hiddenComponents.hide(o)):u(n.appDefinitionId,e,()=>e.components.remove(o))},get:function(e,n,t,{componentRefs:o,properties:r=[],applicationId:p}){const s=i.a.compact(i.a.isArray(o)?o:[o]);return i.a.transform(s,(t,o)=>{const s={componentRef:o},c=!r.includes("components"),u=e.components.serialize(o,null,c);if(i.a.assign(s,i.a.pick(u,r)),i.a.includes(r,"sdkType")&&(s.sdkType=e.wixCode.getCompSdkType(o)),i.a.includes(r,"connections")&&(s.connections=e.platform.controllers.connections.get(o)),i.a.includes(r,"style")&&(s.style=e.components.style.get(o)),i.a.includes(r,"role")){const t=e.platform.controllers.connections.get(o),r=a(n,{applicationId:p},"applicationId",{isRequired:!0}),c=i.a.find(t,n=>i.a.get(e.components.data.get(n.controllerRef),"applicationId")===r);s.role=i.a.get(c,"role")}t.push(s)},[])},serialize:function(e,n,t,{componentRef:o,maintainIdentifiers:i=!1}){return e.components.serialize(o,null,!1,i)},migrate:function(e,n,t,{componentRef:o,componentDefinition:i}){return e.components.migrate(o,i)},getAllComponents:function(e){return e.components.getAllComponents()},getPage:function(e,n,t,{componentRef:o}){return e.components.getPage(o)},getById:function(e,n,t,{id:o}){return e.components.get.byId(o)},getChildren:function(e,n,t,{componentRef:o,recursive:i=!1,fromDocument:r=!1}){return(r?e.components.getChildrenFromFull:e.components.getChildren)(o,i)},getAncestors:function(e,n,t,{componentRef:o}){return e.components.getAncestors(o)},getType:function(e,n,t,{componentRef:o}){return e.components.getType(o)},isFullWidth:function(e,n,t,{componentRef:o}){if(!o)throw new Error("options must include componentRef property");return e.components.is.fullWidth(o)},setFullWidth:function(e,n,t,{componentRef:o,fullWidth:i,margins:r}){if(!o)throw new Error("options must include componentRef property");if("boolean"!=typeof i)throw new Error("options must include fullWidth boolean property");return new Promise(n=>{if(i){const{left:n,right:t}=r||{},i={left:Object.assign({vw:0},n),right:Object.assign({vw:0},t)};e.components.layout.setDock(o,i)}else e.components.layout.unDock(o);c(e,n)})},behaviors:{getRuntimeState:function(e,n,t,{componentRef:o}){return e.components.behaviors.getRuntimeState(o)},execute:function(e,n,t,{componentRef:o,behaviorName:i,behaviorParams:r}){return u(n.appDefinitionId,e,()=>e.components.behaviors.execute(o,i,r)),s(e)},get:function(e,n,t,{componentRef:o}){return e.components.behaviors.get(o)},update:function(e,n,t,{componentRef:o,behavior:i}){return e.components.behaviors.update(o,i)},remove:function(e,n,t,{componentRef:o,behaviorName:i,actionName:r}){return e.components.behaviors.remove(o,i,r)}},properties:{get:function(e,n,t,{componentRef:o}){return e.components.properties.get(o)},update:function(e,n,t,{componentRef:o,props:i}){u(n.appDefinitionId,e,()=>e.components.properties.update(o,i))}},data:{get:function(e,n,t,{componentRef:o}){return e.components.data.get(o)},update:function(e,n,t,{componentRef:o,data:i}){u(n.appDefinitionId,e,()=>e.components.data.update(o,i))},updateInLanguage:function(e,n,t,{componentRef:o,data:i,languageCode:r}){u(n.appDefinitionId,e,()=>e.components.data.updateInLang(o,i,r))}},layout:{get:function(e,n,t,{componentRef:o}){return e.components.layout.get(o)},update:function(e,n,t,{componentRef:o,layout:i}){u(n.appDefinitionId,e,()=>e.components.layout.update(o,i))}},style:{get:function(e,n,t,{componentRef:o}){return e.components.style.get(o)},update:function(e,n,t,{componentRef:o,style:i}){u(n.appDefinitionId,e,()=>e.components.style.setCustom(o,null,i))},updateFull:function(e,n,t,{componentRef:o,style:i}){u(n.appDefinitionId,e,()=>e.components.style.update(o,i))}},stylable:{update:function(e,n,t,{componentRef:o,style:i}){u(n.appDefinitionId,e,()=>e.components.stylable.update(o,i))}},design:{get:function(e,n,t,{componentRef:o}){return e.components.design.get(o)},update:function(e,n,t,{componentRef:o,designItem:i,design:r,retainCharas:p}){u(n.appDefinitionId,e,()=>e.components.design.update(o,r||i,p))}},modes:{showComponentOnlyOnPagesGroup:function(e,n,t,{componentPointer:o,componentRef:i=o,pagesGroupPointer:r}){u(n.appDefinitionId,e,()=>e.components.modes.showComponentOnlyOnPagesGroup(i,r))},activateComponentMode:function(e,n,t,{componentRef:o,modeId:i}){u(n.appDefinitionId,e,()=>e.components.modes.activateComponentMode(o,i))},applyCurrentToAllModes:function(e,n,t,{componentRef:o}){u(n.appDefinitionId,e,()=>e.components.modes.applyCurrentToAllModes(o))},getModes:function(e,n,t,{componentRef:o}){return e.components.modes.getModes(o)}},arrangement:{moveToIndex:function(e,n,t,{componentRef:o,index:i}){return u(n.appDefinitionId,e,()=>e.components.arrangement.moveToIndex(o,i))},getIndex:function(e,n,t,{componentRef:o}){if(!o)throw new Error("options must include componentRef property");return e.components.arrangement.getCompIndex(o)}},refComponents:{removeAllOverrides:function(e,n,t,{componentRef:o}){return new Promise((t,i)=>{if("wysiwyg.viewer.components.RefComponent"===e.components.getType(o))if(d(n,e.components.data.get(o).appDefinitionId)){try{u(n.appDefinitionId,e,()=>e.components.refComponents.removeAllOverrides(o))}catch(e){i(e)}t()}else i("The component with id '".concat(o.id,"' doesn't belong to this app."));else i("This method remove overrides only for a refComponent.")})},openReferredComponent:function(e,n,t,{componentRef:o}){return new Promise((t,i)=>{if("wysiwyg.viewer.components.RefComponent"===e.components.getType(o))if(d(n,e.components.data.get(o).appDefinitionId)){try{u(n.appDefinitionId,e,()=>e.components.refComponents.openReferredComponent(o))}catch(e){i(e)}t()}else i("The component with id '".concat(o.id,"' doesn't belong to this app."));else i("This method only opens a refComponent.")})},closeWidgetToReferredComponent:function(e,n,t,{componentRef:o}){return new Promise((t,i)=>{if("platform.components.AppWidget"===e.components.getType(o))if(d(n,e.components.data.get(o).appDefinitionId))try{t(u(n.appDefinitionId,e,()=>e.components.refComponents.closeWidgetToReferredComponent(o)))}catch(e){i(e)}else i("The component with id '".concat(o.id,"' doesn't belong to this app."));else i("This method closes only appWidget")})},getAllAppRefComponents:function(e,n,t,{appDefinitionId:o}={}){const i=e.components.getAllComponentsFromFull(),r=a(n,{appDefinitionId:o},"appDefinitionId",{isRequired:!0});return i.filter(n=>{const t=e.components.data.get(n)||{};return"WidgetRef"===t.type&&t.appDefinitionId===r})},isRefComponentCollapsed:function(e,n,t,{componentRef:o}){return"COLLAPSED"===i.a.get(e.components.properties.get(o),"ghost")},getCollapsedRefComponents:function(e,n,t,{componentRef:o}){return new Promise((t,r)=>{if("wysiwyg.viewer.components.RefComponent"===e.components.getType(o))if(d(n,e.components.data.get(o).appDefinitionId))try{const n=e.components.refComponents.getAllGhostRefComponentsPrimaryConnection(o);t(i.a.map(n,(n,t)=>({componentRef:e.components.get.byId(t),role:n.role})))}catch(e){r(e)}else r("The component with id '".concat(o.id,"' doesn't belong to this app."));else r("This method get collapsed components only for a refComponent.")})},collapseReferredComponent:function(e,n,t,{componentRef:o}){return new Promise((t,i)=>{if(!e.components.refComponents.isReferredComponent(o))return i("The component with id '".concat(o.id,"' isn't a referred component."));const r=e.components.refComponents.getRefHostCompPointer(o);if(!d(n,e.components.data.get(r).appDefinitionId))return i("The component with id '".concat(o.id,"' doesn't belong to this app."));try{u(n.appDefinitionId,e,()=>e.components.remove(o))}catch(e){return i(e)}t()})},getTemplateComponent:(e,n,t,{componentRef:o})=>e.components.refComponents.getTemplateCompPointer(o),expandReferredComponent:function(e,n,t,{componentRef:o}){return new Promise((t,i)=>{if(!e.components.refComponents.isReferredComponent(o))return i("The component with id '".concat(o.id,"' isn't a referred component."));const r=e.components.refComponents.getRefHostCompPointer(o);if(!d(n,e.components.data.get(r).appDefinitionId))return i("The component with id '".concat(o.id,"' doesn't belong to this app."));try{u(n.appDefinitionId,e,()=>e.components.refComponents.unGhostifyComponent(o))}catch(e){return i(e)}t()})}}};const g={SITE_HEADER:!0,SITE_FOOTER:!0};const m=(e,n)=>i()(n).thru(e.components.getAncestors).reverse().tail().map("id").head();function I(e,{appDefinitionId:n},t,o,i){const r=t?t.id:null,p=n=>{if(r&&e.pages.popupPages.isPopup(r)){return"masterPage"!==e.components.getPage(n).id}return!0};return(i?e.components.getAllComponentsFromFull:e.components.getAllComponents)(r,t=>{const i=e.components.getType(t);return function(e){return"platform.components.AppController"===e||"platform.components.AppWidget"===e}(i)&&e.components.data.get(t).applicationId===n&&p(t)||o&&e.tpa.isTpaByCompType(i)&&e.components.data.get(t).appDefinitionId===n&&p(t)})}function D(e,n,t,o){const r=I(e,n,t,o),p=i()(r).map(e.components.refComponents.getTemplateCompPointer).compact().keyBy("id").value();return i()(r).reject(({id:e})=>p[e]).map(e=>({controllerRef:e})).value()}function y(e,n,t,{controllerRef:o}){return e.platform.controllers.connections.getControllerConnections(o)}var R={listControllers:(e,n,t,{pageRef:o=e.pages.getFocusedPage(),appDefinitionId:i,includeTPAWidget:r}={})=>D(e,{appDefinitionId:a(n,{appDefinitionId:i},"appDefinitionId",{isRequired:!0})},o,r),listAllControllers:(e,n,t,{appDefinitionId:o,includeTPAWidget:i}={})=>D(e,{appDefinitionId:a(n,{appDefinitionId:o},"appDefinitionId",{isRequired:!0})},null,i),listConnectableControllers:function(e,n,t,{componentRef:o,appDefinitionId:r,includeTPAWidget:p}){const s=e.components.getPage(o),c={appDefinitionId:a(n,{appDefinitionId:r},"appDefinitionId",{isRequired:!0})},u=I(e,c,s,p,!0),d=m(e,o);return i()(u).filter(n=>function(e,n,t,o){const i=e.components.getPage(o);if("masterPage"===i.id){const n=m(e,o);return!(n&&!g[n])||t===n}return n===i.id}(e,i.a.get(s,"id"),d,n)).filter(n=>function(e,n,t){return"platform.components.AppWidget"!==e.components.getType(t)||e.components.isDescendantOfComp(n,t)}(e,o,n)).map(e=>({controllerRef:e})).value()},getControllerConnections:y,listControllerConnections:y,listConnections:function(e,n,t,{componentRef:o}){const r=e.platform.controllers.connections.get(o);return i.a.reject(r,{type:"WixCodeConnectionItem"})},listConnectedComponents:function(e,n,t,{controllerRef:o}){return e.platform.controllers.connections.getConnectedComponents(o)},connect:function(e,n,t,{connectToRef:o,controllerRef:i,role:r,connectionConfig:p,isPrimary:a,subRole:s}){return u(n.appDefinitionId,e,()=>e.platform.controllers.connections.connect(o,i,r,p,a,s)),{connectToRef:o,controllerRef:i,role:r,subRole:s}},disconnect:function(e,n,t,{connectToRef:o,controllerRef:i,role:r}){return u(n.appDefinitionId,e,()=>e.platform.controllers.connections.disconnect(o,i,r))},getData:function(e,n,t,{controllerRef:o,scope:r="COMPONENT"}){const p=e.tpa.isTpaByCompType(e.components.getType(o)),a=e.components.data.get(o);if(p)return function(e,{controllerRef:n,compData:t,scope:o}){let i={};e.tpa.data.getPublicData(t.applicationId,n,e=>{if(e.error)throw new Error(e.error);i=e});const r=e.platform.controllers.getName(n);return{type:t.widgetId,config:i[o],displayName:r}}(e,{controllerRef:o,compData:a,scope:r});const s=e.platform.controllers.settings.get(o);return{type:i.a.get(a,"controllerType"),config:s,displayName:e.platform.controllers.getName(o)}},saveConfiguration:function(e,n,t,{controllerRef:o,config:i,scope:r="COMPONENT"}){const p=e.components.getType(o);return e.tpa.isTpaByCompType(p)?new Promise((t,p)=>u(n.appDefinitionId,e,()=>e.tpa.data.setMultiple(o,i,r,e=>e.error?p(new Error(e.error.message)):t(e)))):u(n.appDefinitionId,e,()=>e.platform.controllers.settings.set(o,i))},setDisplayName:function(e,n,t,{controllerRef:o,name:i}){return u(n.appDefinitionId,e,()=>e.platform.controllers.setName(o,i))},setState:function(e,n,t,{state:o}){return u(n.appDefinitionId,e,()=>e.platform.controllers.setState(o))},setExternalId:function(e,n,t,{controllerRef:o,externalId:i}){return u(n.appDefinitionId,e,()=>e.platform.controllers.settings.setExternalId(o,i)),s(e)},getExternalId:function(e,n,t,{controllerRef:o}){return e.platform.controllers.settings.getExternalId(o)}};var P={getFontsOptions:function(e){return e.fonts.getFontsOptions()}};var w={add:function(e,n,t,{label:o}){return new Promise(n=>c(e,()=>{e.history.add(o),n()}))}};function v(e,n,t,{applicationId:o}={}){const i=a(n,{applicationId:o},"applicationId",{isRequired:!0}),r="wix-code"===n.appDefinitionId?e.wixCode.getClientSpec().applicationId:i;return e.tpa.app.getData(r).instance}var h={getSiteId:function(e){return e.generalInfo.getSiteId()},getMetaSiteId:function(e){return e.generalInfo.getMetaSiteId()},getPublicUrl:function(e){return e.generalInfo.getPublicUrl()},isSitePublished:function(e){return e.generalInfo.isSitePublished()},getLanguage:function(e){return e.generalInfo.getLanguage()},getRegionalLanguage:function(e){return e.generalInfo.getRegionalLanguage()},isSiteSaved:function(e){return!e.generalInfo.isFirstSave()&&!e.generalInfo.isDraft()},isHttpsEnabled:function(e){return e.generalInfo.isHttpsEnabled()},getAppInstance:v,getAppInstancePayload:function(e,n,t){const o=v(e,n);return o?function(e){try{const n=e.split(".")[1];return JSON.parse(atob(n))}catch(n){throw new Error("Unable to parse app's instance token. Token - ".concat(e))}}(o):null},getAppInstanceId:function(e,n,t,{applicationId:o}={}){const i=a(n,{applicationId:o},"applicationId",{isRequired:!0}),r="wix-code"===n.appDefinitionId?e.wixCode.getClientSpec().applicationId:i;return e.tpa.app.getData(r).instanceId},getCurrency:function(e){return e.generalInfo.getCurrency()},getTimeZone:function(e){return e.generalInfo.getTimeZone()},getUserId:function(e){return e.generalInfo.getUserInfo().userId},getUserInfo:function(e){return e.generalInfo.getUserInfo()},getVendorProductId:function(e,n,t,o){const r=i.a.get(o,"appDefinitionId");if(!r&&p(n))throw new Error("options must contain appDefinitionId");const a=r?e.platform.getAppDataByAppDefId(r):e.platform.getAppDataByApplicationId(n.applicationId);return i.a.get(a,"vendorProductId")},getRegion:function(e){return e.generalInfo.getLocale()},getArtifactsUrls:function(e,n,t){return e.generalInfo.getArtifactsUrl(t)},getSiteDisplayName:function(e){return e.siteDisplayName.get()},getStageViewMode:function(e){return e.documentMode.getComponentViewMode()},getSiteMap:function(e){return e.tpa.getSiteMap()},getUserGEO:function(e){return e.generalInfo.getGeo()}};var C={add:function(e,n,t,{languageCode:o}){return u(n.appDefinitionId,e,()=>e.language.add(o)),s(e)},current:{set:function(e,n,t,{languageCode:o}){return u(n.appDefinitionId,e,()=>e.language.current.set(o))}},component:{getTranslations:function(e,n,t,{componentRef:o}){return e.language.component.getTranslations(o)},data:{remove:function(e,n,t,o,i){return u(n.appDefinitionId,e,()=>e.multilingual.components.data.remove(o,i))}}},original:{get:function(e){return e.language.original.get()}},setLanguages:function(e,n){return e.language.init(n)},getTranslationLanguages:function(e){return e.language.getFull()},autoTranslate:()=>{throw new Error("not implemented for this editor")},multilingual:{isEnabled:function(e){return e.language.multilingual.isEnabled()},languages:{remove:function(e,n,t,o){return u(n.appDefinitionId,e,()=>e.multilingual.languages.remove(o))},removeAll:function(e,n){return u(n.appDefinitionId,e,()=>e.multilingual.languages.removeAll())}}}};const T=["MEMBERS_SUB_MENU","MEMBERS_LOGIN_MENU","MEMBERS_LOGIN_ICONS_MENU","CUSTOM_MAIN_MENU","CUSTOM_MENU"];var b={create:function(e,n,t,{menuData:o,customId:r,applicationId:p}){const s=a(n,{applicationId:p},"applicationId",{isRequired:!0}),c=i.a.assign({appId:s},o);return u(n.appDefinitionId,e,()=>e.menu.create(c,r))},connect:function(e,n,t,{menuCompPointer:o,menuId:i}){u(n.appDefinitionId,e,()=>e.menu.connect(o,i))},update:function(e,n,t,{menuId:o,menuData:i}){u(n.appDefinitionId,e,()=>e.menu.update(o,i))},remove:function(e,n,t,{menuId:o}){u(n.appDefinitionId,e,()=>e.menu.remove(o))},addItem:function(e,n,t,{menuId:o,menuItem:i}){u(n.appDefinitionId,e,()=>e.menu.addItem(o,i))},getById:function(e,n,t,{menuId:o}){return e.menu.getById(o)},getDefaultMenuId:function(e,n){return u(n.appDefinitionId,e,async()=>{const n=(await e.menu.getAll()).filter(e=>!T.includes(e.id));if(0===n.length)return null;const t=n.find(e=>"MAIN_MENU"===e.menuType),o=n[0];return(t||o).id})}};function E(e,n,t,{pageRef:o,pageLink:r},p){const a=i.a.get(o,"id")||r;if(a)return u(n.appDefinitionId,e,()=>e.pages.navigateTo(a)),s(e,p)}function A(e,n,t,{pageRef:o}){return e.pages.data.get(o.id)}var S={navigateTo:E,setState:function(e,n,t,{state:o}){u(n.appDefinitionId,e,()=>e.platform.pages.setState(o))},getCurrent:function(e){return e.pages.getReference(e.pages.getFocusedPageId())},getPrimary:function(e){return e.pages.getReference(e.pages.getPrimaryPageId())},getHomePage:function(e){const n=e.homePage.get();return e.components.get.byId(n)},add:function(e,n,t,{title:o,definition:i,shouldAddMenuItem:r,shouldNavigateToPage:p=!0}){const a=u(n.appDefinitionId,e,()=>e.pages.add(o,i,r));return p?E(e,n,0,{pageRef:a},a):a},getPageData:A,isDynamicPage:function(e,n,t,{pageRef:o}){const i=e.routers.getRouterRef.byPage(o);return Boolean(i)},rename:function(e,n,t,{pageRef:o,title:i}){return u(n.appDefinitionId,e,()=>e.pages.data.update(o.id,{title:i}))},duplicate:function(e,n,t,{pageId:o,shouldAddMenuItem:i,shouldDuplicatePageCode:r}){return u(n.appDefinitionId,e,()=>e.pages.duplicate(o,i,r))},data:{get:A,getAll:function(e){return e.pages.getPagesData()},update:function(e,n,t,{pageRef:o,data:i}){u(n.appDefinitionId,e,()=>e.pages.data.update(o.id,i))}},pageUriSEO:{convertPageNameToUrl:function(e,n,t,{title:o}){return e.pages.data.pageUriSEO.convertPageNameToUrl(o)}},serialize:function(e,n,t,{pageRef:o,maintainIdentifiers:i=!1}){return e.pages.serialize(o.id,i)},permissions:{hasPassword:function(e,n,t,{pageRef:o}){return e.pages.permissions.hasPassword(o.id)},updatePagePassword:function(e,n,t,{pageRef:o,plainPassword:i}){u(n.appDefinitionId,e,()=>e.pages.permissions.updatePassword(o.id,i))},removePagePassword:function(e,n,t,{pageRef:o}){u(n.appDefinitionId,e,()=>e.pages.permissions.removePassword(o.id))},duplicatePagePassword:function(e,n,t,{destinationPageRef:o,sourcePageRef:i}){return new Promise((t,r)=>{u(n.appDefinitionId,e,()=>e.pages.permissions.duplicatePagePassword(o.id,i.id,t,r))})},duplicateGroupsPermissions:function(){return new Promise(e=>{e()})}},remove:function(e,n,t,{pageRef:o}){return new Promise((t,i)=>{const r=e.pages.data.get(o.id);if(!r)return void i("page with id '".concat(o.id,"' doesn't exist"));if(!d(n,r.managingAppDefId))return void i("page with id '".concat(o.id,"' can not be deleted. page is not managed by this application"));const{id:p}=e.pages.getCurrentPage();if(p===o.id)return void i("It is not allowed to delete current page (".concat(o.id,"), please navigate to another page"));const a=e.homePage.get();if(o.id!==a)if(r.tpaApplicationId)i("It is not allowed to delete a section page '(".concat(o.id,")'"));else{try{u(n.appDefinitionId,e,()=>e.pages.remove(o.id))}catch(e){return void i(e)}t()}else i("It is not allowed to delete homePage (".concat(o.id,"), please set a new page as homePage and try again"))})},getApplicationPages:function(e,n,t,{appDefinitionId:o}={}){const i=a(n,{appDefinitionId:o},"appDefinitionId",{isRequired:!1});return i?e.pages.getPagesData().filter(({managingAppDefId:e})=>e===i):[]},popupPages:{add:(e,n,t,{title:o,definition:i,shouldNavigateToPage:r=!0})=>{const p=u(n.appDefinitionId,e,()=>e.pages.popupPages.add(o,i));return r?E(e,n,0,{pageRef:p},p):p},addConnected:(e,n,t,{title:o,definition:r,controllerType:p,popupRole:s,shouldNavigateToPage:d=!0,appDefinitionId:f})=>new Promise(t=>{u(n.appDefinitionId,e,()=>{const u=e.pages.popupPages.add(o,r),l=a(n,{appDefinitionId:f},"appDefinitionId",{isRequired:!0}),g=i.a.defaultsDeep({data:{controllerType:p,name:p,applicationId:l}},e.components.buildDefaultComponentStructure("platform.components.AppController")),m=e.components.add(u,g);c(e,()=>{const o=e.components.getChildren(u);e.platform.controllers.connections.connect(o[0],m,s,{},!0),t(d?E(e,n,0,{pageRef:u},u):u)})})}),open:(e,n,t,{popupRef:o})=>{const r=i.a.get(o,"id");r&&u(n.appDefinitionId,e,()=>e.pages.popupPages.open(r))},close:(e,n)=>{u(n.appDefinitionId,e,()=>e.pages.popupPages.close())},isPopupOpened:e=>e.pages.popupPages.isPopupOpened(),getApplicationPopups:(e,n,t,{appDefinitionId:o}={})=>{const i=a(n,{appDefinitionId:o},"appDefinitionId",{isRequired:!1});return i?e.pages.popupPages.getDataList().filter(({managingAppDefId:e})=>e===i):[]}}};var x={create:function(e,n,t,{groupName:o,applicationId:i}){const r=a(n,{applicationId:i},"applicationId",{isRequired:!0}),p=u(n.appDefinitionId,e,()=>e.pagesGroup.create({groupName:o,appId:r}));return Promise.resolve(p)},addPageToPagesGroup:function(e,n,t,{pagesGroupPointer:o,pageId:i}){u(n.appDefinitionId,e,()=>e.pagesGroup.addPageToPagesGroup(o,i))},getById:function(e,n,t,{pagesGroupId:o}){return e.pagesGroup.getById(o)},getByGroupName:function(e,n,t,{groupName:o}){return e.pagesGroup.getByGroupName(o)},getAll:function(e,n,t,{applicationId:o}={}){const i=a(n,{applicationId:o},"applicationId",{isRequired:!0});return e.pagesGroup.getAll(i)},remove:function(e,n,t,{pagesGroupPointer:o}){u(n.appDefinitionId,e,()=>e.pagesGroup.remove(o))}};function M(e,n,t,{routerRef:o}){const r=e.routers.get.byRef(o);if(r&&d(n,r.appDefinitionId))return{id:r.id,prefix:r.prefix,config:r.config,pages:i()(r.pages).invertBy().map((n,t)=>({pageRef:e.pages.getReference(t),pageRoles:n})).value()}}function O(e,n,t,{prefix:o}){const i=e.routers.getRouterRef.byPrefix(o);if(!i)return i;const r=e.routers.get.byRef(i);return r&&d(n,r.appDefinitionId)?i:void 0}var N={add:function(e,n,t,{prefix:o,config:i,group:r,appDefinitionId:p}={}){return new Promise(t=>{const s={appDefinitionId:a(n,{appDefinitionId:p},"appDefinitionId",{isRequired:!0}),prefix:o,config:i};r&&(s.group=r);t(u(n.appDefinitionId,e,()=>e.routers.add(s)))})},remove:function(e,n,t,{routerRef:o}){const i=e.routers.get.byRef(o);i&&d(n,i.appDefinitionId)&&u(n.appDefinitionId,e,()=>e.routers.remove(o))},get:M,getAll:function(e,n,t,{appDefinitionId:o}={}){const r=a(n,{appDefinitionId:o},"appDefinitionId",{isRequired:!0});return i.a.map(e.routers.get.byApp(r),({prefix:o})=>{const i=O(e,n,t,{prefix:o});return M(e,n,0,{routerRef:i})})},update:function(e,n,t,{routerRef:o,prefix:i,config:r}){return new Promise((t,p)=>{const a=e.routers.get.byRef(o);a&&d(n,a.appDefinitionId)?(u(n.appDefinitionId,e,()=>e.routers.update(o,{prefix:i,config:r})),t()):p()})},getByPage:function(e,n,t,{pageRef:o}){const i=e.routers.getRouterRef.byPage(o);if(!i)return i;const r=e.routers.get.byRef(i);return r&&d(n,r.appDefinitionId)?i:void 0},getByPrefix:O,isValidPrefix:function(e,n,t,{prefix:o,applicationId:i}){const r=a(n,{applicationId:i},"applicationId",{isRequired:!0});return e.routers.isValidPrefix(r,o)},getCurrentDynamicRouting:function(e){const n=e.routers.getCurrentInnerRoute();if(n.isDynamic){const t=e.routers.get.byId(n.routerId);return n.prefix=t.prefix,n}return null},pages:{add:function(e,n,t,{routerRef:o,pageTitle:i,pageRoles:r}){return new Promise(t=>{const p=e.routers.get.byRef(o);p&&d(n,p.appDefinitionId)||t();t(u(n.appDefinitionId,e,()=>e.routers.pages.add(o,i,r)))})},delete:function(e,n,t,{routerRef:o,pageRef:i}){return new Promise((t,r)=>{const p=e.routers.get.byRef(o);p&&d(n,p.appDefinitionId)?(u(n.appDefinitionId,e,()=>e.pages.remove(i.id)),t()):r()})},connect:function(e,n,t,{routerRef:o,pageRef:i,pageRoles:r}){const p=e.routers.get.byRef(o);p&&d(n,p.appDefinitionId)&&u(n.appDefinitionId,e,()=>e.routers.pages.connect(o,i,r))},disconnect:function(e,n,t,{routerRef:o,pageRef:i}){const r=e.routers.get.byRef(o);r&&d(n,r.appDefinitionId)&&u(n.appDefinitionId,e,()=>e.routers.pages.disconnect(o,i))},move:function(e,n,t,{fromRouterRef:o,toRouterRef:i,pageRef:r}){const p=e.routers.get.byRef(o),a=e.routers.get.byRef(i);p&&a&&d(n,a.appDefinitionId)&&d(n,p.appDefinitionId)&&u(n.appDefinitionId,e,()=>e.routers.pages.move(r,o,i))},listConnectablePages:function(e){return e.routers.pages.listConnectablePages()}}};var F={getFooter:function(e){return e.siteSegments.getFooter()},getHeader:function(e){return e.siteSegments.getHeader()},getPagesContainer:function(e){return e.siteSegments.getPagesContainer()},getSiteStructure:function(e){return e.siteSegments.getSiteStructure()}};var B={getCustomNoPermissionsPageId:function(e){return e.siteMembers.getCustomNoPermissionsPageId()},setCustomNoPermissionsPageId:function(e,n,t,o){return e.siteMembers.setCustomNoPermissionsPageId(o)}};var W={styles:{getAll:function(e){return e.theme.styles.getAll()}},colors:{getAll:function(e){return e.theme.colors.getAll()}},fonts:{getMap:function(e){return e.theme.fonts.getMap()}}};const G=(e,n)=>{const{appDefinitionId:t,applicationId:o}=e.components.data.get(n)||{};return t||o};function q(e,n,t,o){return new Promise((t,r)=>{const p=i.a.clone(o);if(!i.a.get(o,"appDefinitionId"))return void r(new Error("options must contain appDefinitionId"));e.tpa.app.isInstalled(o.appDefinitionId)?r(new Error("Application already installed.")):e.tpa.appMarket.getDataAsync(o.appDefinitionId).then(a=>{if(!a||a.error)return void r(new Error("Application with ".concat(o.appDefinitionId," appDefinitionId do not exist.")));"Wix"===a.by?(p.callback=function(p){if(p.onError)r(new Error(p.onError));else if(n=e.tpa.app.getDataByAppDefId(o.appDefinitionId),p.page){const o=e.pages.data.get(p.page.id);t({instanceId:i.a.get(n,"instanceId"),pageRef:p.page,pageUriSEO:i.a.get(o,"pageUriSEO"),title:i.a.get(o,"title")})}else t({instanceId:i.a.get(n,"instanceId")})},u(n.appDefinitionId,e,()=>e.tpa.app.add(o.appDefinitionId,p))):r(new Error("Can't add a non Wix application"))})})}const U=(e,n)=>t=>{t.error?n(new Error(t.error.message)):e(t)};var k={isAppSectionInstalled:function(e,n,t,{sectionId:o,appDefinitionId:r}={}){return new Promise((t,a)=>{if(!o)return void a(new Error("options must contain sectionId"));let s=n.applicationId;if(!p(n)||r){if(r){const n=e.tpa.app.getDataByAppDefId(r);s=i.a.get(n,"applicationId")}t(e.tpa.section.isSectionInstalledByTpaPageId(s,o))}else a(new Error("options must contain appDefinitionId"))})},isApplicationInstalled:function(e,n,t,{appDefinitionId:o}={}){return new Promise((n,t)=>{if(!o)return void t(new Error("options must contain appDefinitionId"));n(e.tpa.app.isInstalled(o))})},setStyleParams:function(e,n,t,o){return new Promise((t,r)=>{if(!o||!o.compRef)return void r("options must include compRef property");if(!o||!o.styleParams||!i.a.isArray(o.styleParams))return void r("options must include styleParams property and styleParams must be an array");const p=G(e,o.compRef);p?d(n,p)?u(n.appDefinitionId,e,()=>e.tpa.style.setCompStyleParam(o.compRef,o.styleParams,()=>t())):r("It is not allowed to set style params for other applications, application ".concat(n.appDefinitionId," cannot set applications ").concat(p," components style params")):r("could not find component data for the given component ref")})},getStyleParams:function(e,n,t,o){return new Promise((t,i)=>{if(!o||!o.compRef)return void i("options must include compRef property");const r=G(e,o.compRef);if(!r)return void i("could not find component data for the given component ref");if(!d(n,r))return void i("It is not allowed to get the style params from other applications, application ".concat(n.appDefinitionId," cannot get applications ").concat(r," components style params"));const{style:p}=e.tpa.style.getByComp(o.compRef)||{};t(p)})},getSiteTextPresets:function(e,n,t,o){if(!o||!o.compRef)throw new Error("options must include compRef property");const{siteTextPresets:i}=e.tpa.style.get(o.compRef.id);return i},getSiteColors:function(e,n,t,o){if(!o||!o.compRef)throw new Error("options must include compRef property");const{siteColors:i}=e.tpa.style.get(o.compRef.id);return i},data:{getAll:function(e,n,t,o){return new Promise((n,t)=>{if(!o||!o.compRef)return void t(new Error("options must include compRef property"));const{applicationId:i}=e.components.data.get(o.compRef,null,!0)||{};void 0!==i?e.tpa.data.getPublicData(i,o.compRef,U(n,t)):t(new Error("could not find component data for the given component ref"))})},set:function(e,n,t,o){return new Promise((t,i)=>{if(!o||!o.compRef)return void i(new Error("options must include compRef property"));if(!o.key)return void i(new Error("options must include key property"));const r=G(e,o.compRef);r?d(n,r)?u(n.appDefinitionId,e,()=>e.tpa.data.set(o.compRef,o.key,o.value,o.scope||"COMPONENT",U(t,i))):i(new Error("it is not allowed to set the public data from other applications, application ".concat(n.appDefinitionId," cannot set applications ").concat(r," public data"))):i(new Error("could not find component data for the given component ref"))})},remove:function(e,n,t,o){return new Promise((t,i)=>{if(!o||!o.compRef)return void i(new Error("options must include compRef property"));if(!o.key)return void i(new Error("options must include key property"));const r=G(e,o.compRef);r?d(n,r)?u(n.appDefinitionId,e,()=>e.tpa.data.remove(o.compRef,o.key,o.scope||"COMPONENT",U(t,i))):i(new Error("it is not allowed to remove the public data from other applications, application ".concat(n.appDefinitionId," cannot remove applications ").concat(r," public data"))):i(new Error("could not find component data for the given component ref"))})}},add:{application:q,component:function(e,n,t,o){return new Promise((t,r)=>{const a=i.a.clone(o);if(i.a.get(o,"componentType")){if(!o.appDefinitionId){if(p(n))return void r(new Error("options must contain appDefinitionId"));a.appDefinitionId=n.appDefinitionId}if("WIDGET"===o.componentType){if(!i.a.isObject(o.widget))return void r(new Error("options must contain a widget object"));a.widget.tpaWidgetId=o.widget.widgetId}else if("PAGE"===o.componentType){if(!i.a.isObject(o.page))return void r(new Error("options must contain a page object"));if(o.page.isHidden&&!i.a.isBoolean(o.page.isHidden))return void r(new Error("isHidden param should be of type boolean"))}a.callback=function(n){if(n.onError)r(new Error(n.onError));else if("WIDGET"===o.componentType)t({compId:n.comp.id});else{const o=e.pages.data.get(n.page.id);t({compId:n.sectionId,pageRef:n.page,pageUriSEO:i.a.get(o,"pageUriSEO"),title:i.a.get(o,"title")})}},u(n.appDefinitionId,e,()=>e.tpa.comp.add(a))}else r(new Error("options must contain componentType"))})}},app:{getDataByAppDefId:function(e,n,t,o){return e.tpa.app.getDataByAppDefId(o)},getAllCompsByApplicationId:function(e,n,t,o){return e.tpa.app.getAllCompsByApplicationId(o)},refreshApp:function(e,n,{applicationId:t}={}){const o=a(n,{applicationId:t},"applicationId",{isRequired:!0}),i=e.tpa.app.getAllCompsByApplicationId(o);return u(n.appDefinitionId,e,()=>e.tpa.app.refreshApp(i))},delete:function(e,n,{applicationId:t}={}){return new Promise(o=>{const i=a(n,{applicationId:t},"applicationId",{isRequired:!0});u(n.appDefinitionId,e,()=>e.tpa.app.delete(i)),e.waitForChangesApplied(o)})},add:q}};function L(e){return{name:e.name,fullPath:e.location,isDirectory:e.directory}}var _={listChildren:function(e,n,t,o){const r=e.wixCode.fileSystem,p=r.getVirtualDescriptor(o.path,!0);return r.getChildren(p).then(e=>i.a.map(e,L))},readFile:function(e,n,t,o){const i=e.wixCode.fileSystem,r=i.getVirtualDescriptor(o.path,!1);return i.readFile(r)},writeFile:function(e,n,t,o){const i=e.wixCode.fileSystem,r=i.getVirtualDescriptor(o.path,!1);return u(n.appDefinitionId,e,()=>i.writeFile(r,o.content))},deleteFile:function(e,n,t,o){const i=e.wixCode.fileSystem,r=i.getVirtualDescriptor(o.path,!1);return u(n.appDefinitionId,e,()=>i.deleteItem(r))},flush:function(e,n){return u(n.appDefinitionId,e,()=>e.wixCode.fileSystem.flush())},getViewerInfo:function(e){return e.wixCode.fileSystem.getViewerInfo()}};var j={hiddenComponents:{show:function(e,n,t,{componentRef:o}){const i=e.pages.getFocusedPageId();u(n.appDefinitionId,e,()=>e.mobile.hiddenComponents.show(o.id,i))}}};var V={get:function(e,n,t,{componentRef:o}){return e.responsiveLayout.get(o)},update:function(e,n,t,{componentRef:o,responsiveLayout:i}){u(n.appDefinitionId,e,()=>e.responsiveLayout.update(o,i))}};var H={getSkipToContent:function(e){return e.accessibility.skipToContent.get()},setSkipToContent:function(e,n,t,o){return u(n.appDefinitionId,e,()=>e.accessibility.skipToContent.set(o))},getVisualFocus:function(e){return e.accessibility.visualFocus.get()},setVisualFocus:function(e,n,t,o){return u(n.appDefinitionId,e,()=>e.accessibility.visualFocus.set(o))},getAutoDomReorder:function(e){return e.accessibility.autoDomReorder.get()},setAutoDomReorder:function(e,n,t,o){return u(n.appDefinitionId,e,()=>e.accessibility.autoDomReorder.set(o))}};var z={isCoBranded:function(e){return e.account.isCoBranded()}};var X={registerToErrorThrownForContext:function(e,n){const t="registerError_"+n.appDefinitionId;e.platform.requestAPIFromWorker(t).then(({callback:t})=>e.registerToErrorThrownForContext(n.appDefinitionId,t))},unRegisterToErrorThrownForContext:function(e,n){const t="registerError_"+n.appDefinitionId;e.platform.requestAPIFromWorker(t).then(({callback:t})=>e.unRegisterToErrorThrownForContext(n.appDefinitionId,t))}};var Z={migrate:{convertAppPage:function(e,n,t,{pageRef:o}){return e.wixapps.migrate.convertAppPage(o)}}};var J={screen:{getScreenResolution:function(e){return e.env.screen.getResolution()}}};var K={runAndWaitForApproval:async function(e,n,t,o){return await e.transactions.runAndWaitForApproval(o)}};var Q={isGroupsPermissionsGranted:function(){return!0},isCustomPermissionsGranted:function(){return!0}};function Y(e){return new Promise((n,t)=>{e.save(()=>n(),e=>t(e))})}}])}));
//# sourceMappingURL=platform-api.min.js.map